# === ADDENDUM: MVP_MODE (fast-path rules) ===
mvp_addendum:
  id: "A2_mvp_mode"
  version: "2025-08-26"
  description: "Fast-path policy settings to accelerate MVP development while preserving a clear migration path to production rules."

  flags:
    MVP_MODE_ENABLED: true
    ALLOW_MOCKS_IN_MVP: true
    AUTO_CREATE_QUICK_TASKS: true
    AUTO_START_ON_GAP: true
    AUTO_START_GAP_THRESHOLD: 4.0

  relaxations_when_mvp_true:
    - "Relax P1_task_driven: allow quick-task creation when missing (must create task id within same commit/PR)."
    - "Relax P3_minimal_change: allow touching additional files with an auto-amend step that lists added files and requires Composer acknowledgement within N commits."
    - "Relax P4_no_silent_refactor: allow low-risk refactors (code-only, no UI/CSS) if unit tests still pass."
    - "Relax P6_tests_required: require a MinimalTestPlan for MVP (smoke + fast unit) instead of full integration/E2E."
    - "Relax P7_prd_reference: allow PRD-Lite (Acceptance Criteria stub) instead of full PRD; still flag for later full PRD."
    - "Supabase checks: run 'connectivity + sample row' only (no full schema diff)."

  minimal_mvp_artifacts_required:
    - quick_task_template:
        fields:
          - task_id: "<auto>-<timestamp>"
          - title: "Quick: <short description>"
          - type: "code|mvp"
          - files: ["list best-effort files modified"]
          - test_plan:
              type: "minimal"
              steps:
                - "Run lint/compile"
                - "Run designated fast unit tests"
                - "Run smoke curl to changed endpoints (status check only)"
    - prd_lite_template:
        - "Acceptance Criteria: (1-3 concise bullets)"
        - "Out of Scope: (1 line)"
        - "Success Metric (if any): (e.g., 95% of requests < 200ms or N/A for MVP)"
    - minimal_evidence_required:
        - "curl/psql status codes and trimmed stdout (do not attach raw secrets)"
        - "unit test pass summary (names + pass/fail)"
        - "short 1-paragraph summary of changes"

  supabase_mvp_policy:
    check_level: "connectivity_and_sample"
    sample_limit: 1
    psql_usage_in_mvp: false

  mock_data_mvp_handling:
    allowed: true
    annotation_required: true
    removal_deadline: "Before production merge"

  auto_task_amend_policy:
    allow_auto_amend: true
    max_auto_amend_files: 10
    auto_amend_notice: "AI auto-added files to task; Composer must acknowledge or amend within 3 commits or 72 hours."

  timing_and_limits:
    fast_event_latency_target_ms: 150
    nightly_deferred_audit: true
    deferred_audit_scope_in_mvp: "reduced"

  metrics_and_watchlist:
    - "number_of_quick_tasks_created"
    - "mvp_mock_items_present"
    - "average_on_file_change_latency"
    - "gap_score_distribution"
    - "auto_start_trigger_count"

  migration_back_to_production:
    - "Set MVP_MODE_ENABLED to false"
    - "Run full PRD consistency & Supabase full_schema checks for all PBIs"
    - "Enforce mock removal sweep (grep for 'MVP-MOCK' annotations)"
    - "Run full-nightly audit and resolve all flagged gaps before production merges"

# === END MVP_ADDENDUM ===
